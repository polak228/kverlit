<div>
    <h1>Регистрация</h1>
    <form>
        <input type='text' name='username' placeholder='Логин'>
        <input type='password' name='password' placeholder='Пароль'>
        <input type='password' name='password2' placeholder='Повторите пароль'>
        <button type='submit'>Зарегистрироваться</button>
    </form>
</div>

<script>
    const { httpPost } = await this.require('/frontend/framework/index.js');
    const { BACKEND_URL } = await this.require('/frontend/kverlit/shared/constants.js');

    this.root.querySelector('form').addEventListener('submit', e => {
        e.preventDefault();

        const formData = new FormData(e.target);
        const data = Object.fromEntries(new FormData(e.target).entries());
        data.action = 'register';

        if(data.password !== data.password2) {
            alert('Пароли не совпадают');
            return;
        }

        httpPost(BACKEND_URL, data).then(res => {
            console.log(res);
        }).catch(err => {
            console.log(err);
        });
    });
</script>
